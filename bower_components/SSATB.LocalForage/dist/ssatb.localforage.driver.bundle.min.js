!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r;r="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,r.localforage=e()}}(function(){return function e(r,n,t){function o(a,u){if(!n[a]){if(!r[a]){var f="function"==typeof require&&require;if(!u&&f)return f(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var s=n[a]={exports:{}};r[a][0].call(s.exports,function(e){var n=r[a][1][e];return o(n?n:e)},s,s.exports,e,r,n,t)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<t.length;a++)o(t[a]);return o}({1:[function(e,r,n){(function(e){"use strict";function n(){s=!0;for(var e,r,n=l.length;n;){for(r=l,l=[],e=-1;++e<n;)r[e]();n=l.length}s=!1}function t(e){1!==l.push(e)||s||o()}var o,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var a=0,u=new i(n),f=e.document.createTextNode("");u.observe(f,{characterData:!0}),o=function(){f.data=a=++a%2}}else if(e.setImmediate||"undefined"==typeof e.MessageChannel)o="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var r=e.document.createElement("script");r.onreadystatechange=function(){n(),r.onreadystatechange=null,r.parentNode.removeChild(r),r=null},e.document.documentElement.appendChild(r)}:function(){setTimeout(n,0)};else{var c=new e.MessageChannel;c.port1.onmessage=n,o=function(){c.port2.postMessage(0)}}var s,l=[];r.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,r,n){"use strict";function t(){}function o(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,e!==t&&f(this,e)}function i(e,r,n){this.promise=e,"function"==typeof r&&(this.onFulfilled=r,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function a(e,r,n){h(function(){var t;try{t=r(n)}catch(o){return p.reject(e,o)}t===e?p.reject(e,new TypeError("Cannot resolve promise with itself")):p.resolve(e,t)})}function u(e){var r=e&&e.then;if(e&&"object"==typeof e&&"function"==typeof r)return function(){r.apply(e,arguments)}}function f(e,r){function n(r){i||(i=!0,p.reject(e,r))}function t(r){i||(i=!0,p.resolve(e,r))}function o(){r(t,n)}var i=!1,a=c(o);"error"===a.status&&n(a.value)}function c(e,r){var n={};try{n.value=e(r),n.status="success"}catch(t){n.status="error",n.value=t}return n}function s(e){return e instanceof this?e:p.resolve(new this(t),e)}function l(e){var r=new this(t);return p.reject(r,e)}function d(e){function r(e,r){function t(e){a[r]=e,++u!==o||i||(i=!0,p.resolve(c,a))}n.resolve(e).then(t,function(e){i||(i=!0,p.reject(c,e))})}var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var o=e.length,i=!1;if(!o)return this.resolve([]);for(var a=new Array(o),u=0,f=-1,c=new this(t);++f<o;)r(e[f],f);return c}function v(e){function r(e){n.resolve(e).then(function(e){i||(i=!0,p.resolve(u,e))},function(e){i||(i=!0,p.reject(u,e))})}var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var o=e.length,i=!1;if(!o)return this.resolve([]);for(var a=-1,u=new this(t);++a<o;)r(e[a]);return u}var h=e(1),p={},y=["REJECTED"],g=["FULFILLED"],m=["PENDING"];r.exports=n=o,o.prototype["catch"]=function(e){return this.then(null,e)},o.prototype.then=function(e,r){if("function"!=typeof e&&this.state===g||"function"!=typeof r&&this.state===y)return this;var n=new this.constructor(t);if(this.state!==m){var o=this.state===g?e:r;a(n,o,this.outcome)}else this.queue.push(new i(n,e,r));return n},i.prototype.callFulfilled=function(e){p.resolve(this.promise,e)},i.prototype.otherCallFulfilled=function(e){a(this.promise,this.onFulfilled,e)},i.prototype.callRejected=function(e){p.reject(this.promise,e)},i.prototype.otherCallRejected=function(e){a(this.promise,this.onRejected,e)},p.resolve=function(e,r){var n=c(u,r);if("error"===n.status)return p.reject(e,n.value);var t=n.value;if(t)f(e,t);else{e.state=g,e.outcome=r;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(r)}return e},p.reject=function(e,r){e.state=y,e.outcome=r;for(var n=-1,t=e.queue.length;++n<t;)e.queue[n].callRejected(r);return e},n.resolve=s,n.reject=l,n.all=d,n.race=v},{1:1}],3:[function(e,r,n){(function(r){"use strict";"function"!=typeof r.Promise&&(r.Promise=e(2))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,r,n){"use strict";function t(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function o(){return"undefined"!=typeof indexedDB?indexedDB:"undefined"!=typeof webkitIndexedDB?webkitIndexedDB:"undefined"!=typeof mozIndexedDB?mozIndexedDB:"undefined"!=typeof OIndexedDB?OIndexedDB:"undefined"!=typeof msIndexedDB?msIndexedDB:void 0}function i(){try{return!!ie&&(!("undefined"!=typeof openDatabase&&"undefined"!=typeof navigator&&navigator.userAgent&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent))&&(ie&&"function"==typeof ie.open&&"undefined"!=typeof IDBKeyRange))}catch(e){return!1}}function a(){return"function"==typeof openDatabase}function u(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&localStorage.setItem}catch(e){return!1}}function f(e,r){e=e||[],r=r||{};try{return new Blob(e,r)}catch(n){if("TypeError"!==n.name)throw n;for(var t="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,o=new t,i=0;i<e.length;i+=1)o.append(e[i]);return o.getBlob(r.type)}}function c(e,r){r&&e.then(function(e){r(null,e)},function(e){r(e)})}function s(e){for(var r=e.length,n=new ArrayBuffer(r),t=new Uint8Array(n),o=0;o<r;o++)t[o]=e.charCodeAt(o);return n}function l(e){return new fe(function(r){var n=f([""]);e.objectStore(ce).put(n,"key"),e.onabort=function(e){e.preventDefault(),e.stopPropagation(),r(!1)},e.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);r(n||!e||parseInt(e[1],10)>=43)}})["catch"](function(){return!1})}function d(e){return"boolean"==typeof ae?fe.resolve(ae):l(e).then(function(e){return ae=e})}function v(e){var r=ue[e.name],n={};n.promise=new fe(function(e){n.resolve=e}),r.deferredOperations.push(n),r.dbReady?r.dbReady=r.dbReady.then(function(){return n.promise}):r.dbReady=n.promise}function h(e){var r=ue[e.name],n=r.deferredOperations.pop();n&&n.resolve()}function p(e,r){return new fe(function(n,t){if(e.db){if(!r)return n(e.db);v(e),e.db.close()}var o=[e.name];r&&o.push(e.version);var i=ie.open.apply(ie,o);r&&(i.onupgradeneeded=function(r){var n=i.result;try{n.createObjectStore(e.storeName),r.oldVersion<=1&&n.createObjectStore(ce)}catch(t){if("ConstraintError"!==t.name)throw t;console.warn('The database "'+e.name+'" has been upgraded from version '+r.oldVersion+" to version "+r.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),i.onerror=function(){t(i.error)},i.onsuccess=function(){n(i.result),h(e)}})}function y(e){return p(e,!1)}function g(e){return p(e,!0)}function m(e,r){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),t=e.version<e.db.version,o=e.version>e.db.version;if(t&&(e.version!==r&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||n){if(n){var i=e.db.version+1;i>e.version&&(e.version=i)}return!0}return!1}function b(e){return new fe(function(r,n){var t=new FileReader;t.onerror=n,t.onloadend=function(n){var t=btoa(n.target.result||"");r({__local_forage_encoded_blob:!0,data:t,type:e.type})},t.readAsBinaryString(e)})}function w(e){var r=s(atob(e.data));return f([r],{type:e.type})}function E(e){return e&&e.__local_forage_encoded_blob}function _(e){var r=this,n=r._initReady().then(function(){var e=ue[r._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return n.then(e,e),n}function S(e){function r(){return fe.resolve()}var n=this,t={db:null};if(e)for(var o in e)t[o]=e[o];ue||(ue={});var i=ue[t.name];i||(i={forages:[],db:null,dbReady:null,deferredOperations:[]},ue[t.name]=i),i.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=_);for(var a=[],u=0;u<i.forages.length;u++){var f=i.forages[u];f!==n&&a.push(f._initReady()["catch"](r))}var c=i.forages.slice(0);return fe.all(a).then(function(){return t.db=i.db,y(t)}).then(function(e){return t.db=e,m(t,n._defaultConfig.version)?g(t):e}).then(function(e){t.db=i.db=e,n._dbInfo=t;for(var r=0;r<c.length;r++){var o=c[r];o!==n&&(o._dbInfo.db=t.db,o._dbInfo.version=t.version)}})}function I(e,r){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var t=new fe(function(r,t){n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=i.get(e);a.onsuccess=function(){var e=a.result;void 0===e&&(e=null),E(e)&&(e=w(e)),r(e)},a.onerror=function(){t(a.error)}})["catch"](t)});return c(t,r),t}function k(e,r){var n=this,t=new fe(function(r,t){n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=i.openCursor(),u=1;a.onsuccess=function(){var n=a.result;if(n){var t=n.value;E(t)&&(t=w(t));var o=e(t,n.key,u++);void 0!==o?r(o):n["continue"]()}else r()},a.onerror=function(){t(a.error)}})["catch"](t)});return c(t,r),t}function j(e,r,n){var t=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=new fe(function(n,o){var i;t.ready().then(function(){return i=t._dbInfo,r instanceof Blob?d(i.db).then(function(e){return e?r:b(r)}):r}).then(function(r){var t=i.db.transaction(i.storeName,"readwrite"),a=t.objectStore(i.storeName);null===r&&(r=void 0),t.oncomplete=function(){void 0===r&&(r=null),n(r)},t.onabort=t.onerror=function(){var e=u.error?u.error:u.transaction.error;o(e)};var u=a.put(r,e)})["catch"](o)});return c(o,n),o}function D(e,r){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var t=new fe(function(r,t){n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readwrite"),a=i.objectStore(o.storeName),u=a["delete"](e);i.oncomplete=function(){r()},i.onerror=function(){t(u.error)},i.onabort=function(){var e=u.error?u.error:u.transaction.error;t(e)}})["catch"](t)});return c(t,r),t}function x(e){var r=this,n=new fe(function(e,n){r.ready().then(function(){var t=r._dbInfo,o=t.db.transaction(t.storeName,"readwrite"),i=o.objectStore(t.storeName),a=i.clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=a.error?a.error:a.transaction.error;n(e)}})["catch"](n)});return c(n,e),n}function A(e){var r=this,n=new fe(function(e,n){r.ready().then(function(){var t=r._dbInfo,o=t.db.transaction(t.storeName,"readonly").objectStore(t.storeName),i=o.count();i.onsuccess=function(){e(i.result)},i.onerror=function(){n(i.error)}})["catch"](n)});return c(n,e),n}function N(e,r){var n=this,t=new fe(function(r,t){return e<0?void r(null):void n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=!1,u=i.openCursor();u.onsuccess=function(){var n=u.result;return n?void(0===e?r(n.key):a?r(n.key):(a=!0,n.advance(e))):void r(null)},u.onerror=function(){t(u.error)}})["catch"](t)});return c(t,r),t}function O(e){var r=this,n=new fe(function(e,n){r.ready().then(function(){var t=r._dbInfo,o=t.db.transaction(t.storeName,"readonly").objectStore(t.storeName),i=o.openCursor(),a=[];i.onsuccess=function(){var r=i.result;return r?(a.push(r.key),void r["continue"]()):void e(a)},i.onerror=function(){n(i.error)}})["catch"](n)});return c(n,e),n}function R(e){var r,n,t,o,i,a=.75*e.length,u=e.length,f=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var c=new ArrayBuffer(a),s=new Uint8Array(c);for(r=0;r<u;r+=4)n=le.indexOf(e[r]),t=le.indexOf(e[r+1]),o=le.indexOf(e[r+2]),i=le.indexOf(e[r+3]),s[f++]=n<<2|t>>4,s[f++]=(15&t)<<4|o>>2,s[f++]=(3&o)<<6|63&i;return c}function T(e){var r,n=new Uint8Array(e),t="";for(r=0;r<n.length;r+=3)t+=le[n[r]>>2],t+=le[(3&n[r])<<4|n[r+1]>>4],t+=le[(15&n[r+1])<<2|n[r+2]>>6],t+=le[63&n[r+2]];return n.length%3===2?t=t.substring(0,t.length-1)+"=":n.length%3===1&&(t=t.substring(0,t.length-2)+"=="),t}function B(e,r){var n="";if(e&&(n=e.toString()),e&&("[object ArrayBuffer]"===e.toString()||e.buffer&&"[object ArrayBuffer]"===e.buffer.toString())){var t,o=he;e instanceof ArrayBuffer?(t=e,o+=ye):(t=e.buffer,"[object Int8Array]"===n?o+=me:"[object Uint8Array]"===n?o+=be:"[object Uint8ClampedArray]"===n?o+=we:"[object Int16Array]"===n?o+=Ee:"[object Uint16Array]"===n?o+=Se:"[object Int32Array]"===n?o+=_e:"[object Uint32Array]"===n?o+=Ie:"[object Float32Array]"===n?o+=ke:"[object Float64Array]"===n?o+=je:r(new Error("Failed to get type for BinaryArray"))),r(o+T(t))}else if("[object Blob]"===n){var i=new FileReader;i.onload=function(){var n=de+e.type+"~"+T(this.result);r(he+ge+n)},i.readAsArrayBuffer(e)}else try{r(JSON.stringify(e))}catch(a){console.error("Couldn't convert value into a JSON string: ",e),r(null,a)}}function F(e){if(e.substring(0,pe)!==he)return JSON.parse(e);var r,n=e.substring(De),t=e.substring(pe,De);if(t===ge&&ve.test(n)){var o=n.match(ve);r=o[1],n=n.substring(o[0].length)}var i=R(n);switch(t){case ye:return i;case ge:return f([i],{type:r});case me:return new Int8Array(i);case be:return new Uint8Array(i);case we:return new Uint8ClampedArray(i);case Ee:return new Int16Array(i);case Se:return new Uint16Array(i);case _e:return new Int32Array(i);case Ie:return new Uint32Array(i);case ke:return new Float32Array(i);case je:return new Float64Array(i);default:throw new Error("Unkown type: "+t)}}function L(e){var r=this,n={db:null};if(e)for(var t in e)n[t]="string"!=typeof e[t]?e[t].toString():e[t];var o=new fe(function(e,t){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(o){return t(o)}n.db.transaction(function(o){o.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){r._dbInfo=n,e()},function(e,r){t(r)})})});return n.serializer=xe,o}function C(e,r){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var t=new fe(function(r,t){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],function(e,n){var t=n.rows.length?n.rows.item(0).value:null;t&&(t=o.serializer.deserialize(t)),r(t)},function(e,r){t(r)})})})["catch"](t)});return c(t,r),t}function U(e,r){var n=this,t=new fe(function(r,t){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT * FROM "+o.storeName,[],function(n,t){for(var i=t.rows,a=i.length,u=0;u<a;u++){var f=i.item(u),c=f.value;if(c&&(c=o.serializer.deserialize(c)),c=e(c,f.key,u+1),void 0!==c)return void r(c)}r()},function(e,r){t(r)})})})["catch"](t)});return c(t,r),t}function M(e,r,n){var t=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=new fe(function(n,o){t.ready().then(function(){void 0===r&&(r=null);var i=r,a=t._dbInfo;a.serializer.serialize(r,function(r,t){t?o(t):a.db.transaction(function(t){t.executeSql("INSERT OR REPLACE INTO "+a.storeName+" (key, value) VALUES (?, ?)",[e,r],function(){n(i)},function(e,r){o(r)})},function(e){e.code===e.QUOTA_ERR&&o(e)})})})["catch"](o)});return c(o,n),o}function q(e,r){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var t=new fe(function(r,t){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("DELETE FROM "+o.storeName+" WHERE key = ?",[e],function(){r()},function(e,r){t(r)})})})["catch"](t)});return c(t,r),t}function $(e){var r=this,n=new fe(function(e,n){r.ready().then(function(){var t=r._dbInfo;t.db.transaction(function(r){r.executeSql("DELETE FROM "+t.storeName,[],function(){e()},function(e,r){n(r)})})})["catch"](n)});return c(n,e),n}function P(e){var r=this,n=new fe(function(e,n){r.ready().then(function(){var t=r._dbInfo;t.db.transaction(function(r){r.executeSql("SELECT COUNT(key) as c FROM "+t.storeName,[],function(r,n){var t=n.rows.item(0).c;e(t)},function(e,r){n(r)})})})["catch"](n)});return c(n,e),n}function H(e,r){var n=this,t=new fe(function(r,t){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,n){var t=n.rows.length?n.rows.item(0).key:null;r(t)},function(e,r){t(r)})})})["catch"](t)});return c(t,r),t}function z(e){var r=this,n=new fe(function(e,n){r.ready().then(function(){var t=r._dbInfo;t.db.transaction(function(r){r.executeSql("SELECT key FROM "+t.storeName,[],function(r,n){for(var t=[],o=0;o<n.rows.length;o++)t.push(n.rows.item(o).key);e(t)},function(e,r){n(r)})})})["catch"](n)});return c(n,e),n}function W(e){var r=this,n={};if(e)for(var t in e)n[t]=e[t];return n.keyPrefix=n.name+"/",n.storeName!==r._defaultConfig.storeName&&(n.keyPrefix+=n.storeName+"/"),r._dbInfo=n,n.serializer=xe,fe.resolve()}function V(e){var r=this,n=r.ready().then(function(){for(var e=r._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var t=localStorage.key(n);0===t.indexOf(e)&&localStorage.removeItem(t)}});return c(n,e),n}function Y(e,r){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var t=n.ready().then(function(){var r=n._dbInfo,t=localStorage.getItem(r.keyPrefix+e);return t&&(t=r.serializer.deserialize(t)),t});return c(t,r),t}function Q(e,r){var n=this,t=n.ready().then(function(){for(var r=n._dbInfo,t=r.keyPrefix,o=t.length,i=localStorage.length,a=1,u=0;u<i;u++){var f=localStorage.key(u);if(0===f.indexOf(t)){var c=localStorage.getItem(f);if(c&&(c=r.serializer.deserialize(c)),c=e(c,f.substring(o),a++),void 0!==c)return c}}});return c(t,r),t}function X(e,r){var n=this,t=n.ready().then(function(){var r,t=n._dbInfo;try{r=localStorage.key(e)}catch(o){r=null}return r&&(r=r.substring(t.keyPrefix.length)),r});return c(t,r),t}function G(e){var r=this,n=r.ready().then(function(){for(var e=r._dbInfo,n=localStorage.length,t=[],o=0;o<n;o++)0===localStorage.key(o).indexOf(e.keyPrefix)&&t.push(localStorage.key(o).substring(e.keyPrefix.length));return t});return c(n,e),n}function K(e){var r=this,n=r.keys().then(function(e){return e.length});return c(n,e),n}function J(e,r){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var t=n.ready().then(function(){var r=n._dbInfo;localStorage.removeItem(r.keyPrefix+e)});return c(t,r),t}function Z(e,r,n){var t=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=t.ready().then(function(){void 0===r&&(r=null);var n=r;return new fe(function(o,i){var a=t._dbInfo;a.serializer.serialize(r,function(r,t){if(t)i(t);else try{localStorage.setItem(a.keyPrefix+e,r),o(n)}catch(u){"QuotaExceededError"!==u.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==u.name||i(u),i(u)}})})});return c(o,n),o}function ee(e,r,n){"function"==typeof r&&e.then(r),"function"==typeof n&&e["catch"](n)}function re(e,r){e[r]=function(){var n=arguments;return e.ready().then(function(){return e[r].apply(e,n)})}}function ne(){for(var e=1;e<arguments.length;e++){var r=arguments[e];if(r)for(var n in r)r.hasOwnProperty(n)&&(Ce(r[n])?arguments[0][n]=r[n].slice():arguments[0][n]=r[n])}return arguments[0]}function te(e){for(var r in Re)if(Re.hasOwnProperty(r)&&Re[r]===e)return!0;return!1}var oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},ie=o();"undefined"==typeof Promise&&"undefined"!=typeof e&&e(3);var ae,ue,fe=Promise,ce="local-forage-detect-blob-support",se={_driver:"asyncStorage",_initStorage:S,iterate:k,getItem:I,setItem:j,removeItem:D,clear:x,length:A,key:N,keys:O},le="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",de="~~local_forage_type~",ve=/^~~local_forage_type~([^~]+)~/,he="__lfsc__:",pe=he.length,ye="arbf",ge="blob",me="si08",be="ui08",we="uic8",Ee="si16",_e="si32",Se="ur16",Ie="ui32",ke="fl32",je="fl64",De=pe+ye.length,xe={serialize:B,deserialize:F,stringToBuffer:R,bufferToString:T},Ae={_driver:"webSQLStorage",_initStorage:L,iterate:U,getItem:C,setItem:M,removeItem:q,clear:$,length:P,key:H,keys:z},Ne={_driver:"localStorageWrapper",_initStorage:W,iterate:Q,getItem:Y,setItem:Z,removeItem:J,clear:V,length:K,key:X,keys:G},Oe={},Re={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},Te=[Re.INDEXEDDB,Re.WEBSQL,Re.LOCALSTORAGE],Be=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],Fe={description:"",driver:Te.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},Le={};Le[Re.INDEXEDDB]=i(),Le[Re.WEBSQL]=a(),Le[Re.LOCALSTORAGE]=u();var Ce=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Ue=function(){function e(r){t(this,e),this.INDEXEDDB=Re.INDEXEDDB,this.LOCALSTORAGE=Re.LOCALSTORAGE,this.WEBSQL=Re.WEBSQL,this._defaultConfig=ne({},Fe),this._config=ne({},this._defaultConfig,r),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)}return e.prototype.config=function(e){if("object"===("undefined"==typeof e?"undefined":oe(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var r in e)"storeName"===r&&(e[r]=e[r].replace(/\W/g,"_")),this._config[r]=e[r];return"driver"in e&&e.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,r,n){var t=new fe(function(r,n){try{var t=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),i=new Error("Custom driver name already in use: "+e._driver);if(!e._driver)return void n(o);if(te(e._driver))return void n(i);for(var a=Be.concat("_initStorage"),u=0;u<a.length;u++){var f=a[u];if(!f||!e[f]||"function"!=typeof e[f])return void n(o)}var c=fe.resolve(!0);"_support"in e&&(c=e._support&&"function"==typeof e._support?e._support():fe.resolve(!!e._support)),c.then(function(n){Le[t]=n,Oe[t]=e,r()},n)}catch(s){n(s)}});return ee(t,r,n),t},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,r,n){var t=this,o=fe.resolve().then(function(){if(!te(e)){if(Oe[e])return Oe[e];throw new Error("Driver not found.")}switch(e){case t.INDEXEDDB:return se;case t.LOCALSTORAGE:return Ne;case t.WEBSQL:return Ae}});return ee(o,r,n),o},e.prototype.getSerializer=function(e){var r=fe.resolve(xe);return ee(r,e),r},e.prototype.ready=function(e){var r=this,n=r._driverSet.then(function(){return null===r._ready&&(r._ready=r._initDriver()),r._ready});return ee(n,e,e),n},e.prototype.setDriver=function(e,r,n){function t(){i._config.driver=i.driver()}function o(e){return function(){function r(){for(;n<e.length;){var o=e[n];return n++,i._dbInfo=null,i._ready=null,i.getDriver(o).then(function(e){return i._extend(e),t(),i._ready=i._initStorage(i._config),i._ready})["catch"](r)}t();var a=new Error("No available storage method found.");return i._driverSet=fe.reject(a),i._driverSet}var n=0;return r()}}var i=this;Ce(e)||(e=[e]);var a=this._getSupportedDrivers(e),u=null!==this._driverSet?this._driverSet["catch"](function(){return fe.resolve()}):fe.resolve();return this._driverSet=u.then(function(){var e=a[0];return i._dbInfo=null,i._ready=null,i.getDriver(e).then(function(e){i._driver=e._driver,t(),i._wrapLibraryMethodsWithReady(),i._initDriver=o(a)})})["catch"](function(){t();var e=new Error("No available storage method found.");return i._driverSet=fe.reject(e),i._driverSet}),ee(this._driverSet,r,n),this._driverSet},e.prototype.supports=function(e){return!!Le[e]},e.prototype._extend=function(e){ne(this,e)},e.prototype._getSupportedDrivers=function(e){for(var r=[],n=0,t=e.length;n<t;n++){var o=e[n];this.supports(o)&&r.push(o)}return r},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0;e<Be.length;e++)re(this,Be[e])},e.prototype.createInstance=function(r){return new e(r)},e}(),Me=new Ue;r.exports=Me},{3:3}]},{},[4])(4)}),function(e,r){"use strict";var n=e&&e.angular||window&&window.angular;if("function"==typeof define&&define.amd)define(["localforage"],function(e){r(n,e)});else{if("object"!=typeof exports&&"object"!=typeof global)return r(n,e.localforage);module.exports=r(n,require("localforage"))}}(this,function(e,r,n){"use strict";var t=e.module("LocalForageModule",["ng"]);return t.provider("$localForage",function(){var n={},t={name:"lf"},o={setItem:!1,removeItem:!1},i={};this.setNotify=function(e,r){o={setItem:e,removeItem:r}},this.config=function(r){if(!e.isObject(r))throw new Error("The config parameter should be an object");e.extend(t,r)},this.$get=["$rootScope","$q","$parse",function(a,u,f){var c=function(n){e.isDefined(n)?this._localforage=r.createInstance(n):(this._localforage=r,r.config(t))};c.prototype.createInstance=function(r){if(e.isObject(r)){if(r=e.extend({},t,r),e.isDefined(n[r.name]))throw new Error("A localForage instance with the name "+r.name+" is already defined.");return n[r.name]=new c(r),n[r.name]}throw new Error("The parameter should be a config object.")},c.prototype.instance=function(r){if(e.isUndefined(r))return n[t.name];if(e.isString(r)){if(e.isDefined(n[r]))return n[r];throw new Error("No localForage instance of that name exists.")}throw new Error("The parameter should be a string.")},c.prototype.setDriver=function(e){return this._localforage.setDriver(e)},c.prototype.driver=function(){return this._localforage.driver()},c.prototype.setItem=function(r,n){if(e.isUndefined(r))throw new Error("You must define a key to set");var t=this;if(e.isArray(r)){if(!e.isArray(n))throw new Error("If you set an array of keys, the values should be an array too");var i=[];return e.forEach(r,function(e,r){i.push(t.setItem(e,n[r]))}),u.all(i)}var f=u.defer(),c=arguments,s="undefined"!=typeof Blob&&"undefined"!=typeof ArrayBuffer&&(n instanceof Blob||n instanceof ArrayBuffer)?n:e.copy(n);return e.isObject(s)&&e.isDefined(s.$promise)&&delete s.$promise,t._localforage.setItem(t.prefix()+r,s).then(function(){o.setItem&&a.$broadcast("LocalForageModule.setItem",{key:r,newvalue:s,driver:t.driver()}),f.resolve(s)},function(e){t.onError(e,c,t.setItem,f)}),f.promise},c.prototype.getItem=function(r,n){if(e.isUndefined(r))throw new Error("You must define a key to get");var t,o=u.defer(),i=arguments,a=this;if(e.isArray(r)){var f=[],c=0;t=a._localforage.iterate(function(e,n){var t=r.indexOf(a.prefix()+n);if(t>-1&&(f[t]=e,c++),c===r.length)return f}).then(function(){for(var t=!0,i=0;i<r.length;i++)e.isUndefined(f[i])&&(f[i]=null,t=!1);t||!n?o.resolve(f):o.reject(f)})}else t=a._localforage.getItem(a.prefix()+r).then(function(e){n&&null===e?o.reject(e):o.resolve(e)});return t.then(null,function(e){a.onError(e,i,a.getItem,o)}),o.promise},c.prototype.iterate=function(r){if(e.isUndefined(r))throw new Error("You must define a callback to iterate");var n=u.defer(),t=arguments,o=this;return o._localforage.iterate(r).then(function(e){n.resolve(e)},function(e){o.onError(e,t,o.iterate,n)}),n.promise},c.prototype.removeItem=function(r){if(e.isUndefined(r))throw new Error("You must define a key to remove");var n=this;if(e.isArray(r)){var t=[];return e.forEach(r,function(e,r){t.push(n.removeItem(e))}),u.all(t)}var i=u.defer(),f=arguments;return n._localforage.removeItem(n.prefix()+r).then(function(){o.removeItem&&a.$broadcast("LocalForageModule.removeItem",{key:r,driver:n.driver()}),i.resolve()},function(e){n.onError(e,f,n.removeItem,i)}),i.promise},c.prototype.pull=function(r){if(e.isUndefined(r))throw new Error("You must define a key to pull");var n=this,t=u.defer(),o=function(e){t.reject(e)};return n.getItem(r).then(function(e){n.removeItem(r).then(function(){t.resolve(e)},o)},o),t.promise},c.prototype.clear=function(){var e=u.defer(),r=arguments,n=this;return n._localforage.clear().then(function(r){e.resolve()},function(t){n.onError(t,r,n.clear,e)}),e.promise},c.prototype.key=function(r){if(e.isUndefined(r))throw new Error("You must define a position to get for the key function");var n=u.defer(),t=arguments,o=this;return o._localforage.key(r).then(function(e){n.resolve(e)},function(e){o.onError(e,t,o.key,n)}),n.promise};var s=function(){var e=u.defer(),r=arguments,n=this;return n._localforage.keys().then(function(r){if(t.oldPrefix&&"localStorageWrapper"===n.driver()){for(var o=[],i=0,a=r.length;i<a;i++)o.push(r[i].substr(n.prefix().length,r[i].length));r=o}e.resolve(r)},function(t){n.onError(t,r,n.keys,e)}),e.promise};return c.prototype.keys=s,c.prototype.getKeys=s,c.prototype.length=function(){var e=u.defer(),r=arguments,n=this;return n._localforage.length().then(function(r){e.resolve(r)},function(t){n.onError(t,r,length,e)}),e.promise},c.prototype.bind=function(r,o){if(e.isString(o))o={key:o};else if(!e.isObject(o)||e.isUndefined(o.key))throw new Error("You must define a key to bind");var a={defaultValue:"",name:t.name};o=e.extend({},a,o);var u=n[o.name];if(e.isUndefined(u))throw new Error("You must use the name of an existing instance");var c=o.scopeKey||o.key,s=f(c);return u.getItem(o.key).then(function(n){return null!==n?s.assign(r,n):e.isUndefined(o.defaultValue)||(s.assign(r,o.defaultValue),u.setItem(o.key,o.defaultValue)),e.isDefined(i[o.key])&&i[o.key](),i[o.key]=r.$watch(c,function(r){e.isDefined(r)&&u.setItem(o.key,r)},!0),n})},c.prototype.unbind=function(r,o){if(e.isString(o))o={key:o};else if(!e.isObject(o)||e.isUndefined(o.key))throw new Error("You must define a key to unbind");var a={scopeKey:o.key,name:t.name};o=e.extend({},a,o);var u=n[o.name];if(e.isUndefined(u))throw new Error("You must use the name of an existing instance");return f(o.scopeKey).assign(r,null),e.isDefined(i[o.key])&&(i[o.key](),delete i[o.key]),u.removeItem(o.key)},c.prototype.prefix=function(){return"localStorageWrapper"===this.driver()&&t.oldPrefix?this._localforage.config().name+".":""},c.prototype.onError=function(r,n,t,o){if((e.isObject(r)&&r.name?"InvalidStateError"===r.name:e.isString(r)&&"InvalidStateError"===r)&&"asyncStorage"===this.driver()||e.isObject(r)&&r.code&&5===r.code){var i=this;i.setDriver("localStorageWrapper").then(function(){t.apply(i,n).then(function(e){o.resolve(e)},function(e){o.reject(e)})},function(){o.reject(r)})}else o.reject(r)},n[t.name]=new c,n[t.name]}]}),t.directive("localForage",["$localForage",function(r){return{restrict:"A",link:function(n,t,o){var i=n.$eval(o.localForage);e.isObject(i)&&e.isDefined(i.key)?r.bind(n,i):r.bind(n,o.localForage)}}}]),t.name});var localforageSsatbDriver={DRIVER_NAME:"localForage-SsatbDriver"};(function(){"use strict";function e(e){var r=this;return e&&(r._apiInfo=e.apiInfo),h.resolve()}function r(e,r){var n=null;if(null!=e)if(null!=r){var t=r.getAllResponseHeaders(),o=t.split("\n"),n={};for(var i in o){var a=o[i],u=a.split(":"),f=u[0];if(f&&(f=f.trim(),0!=f.length)){var c=u[1];c&&(c=c.trim()),n[f]=c}}}else console.warn("jqXHR is null. Headers not populated");return null!=n&&(e.responseHeaders=n),e}function n(e,r){var n=this,t=new h(function(r,t){n.ready().then(function(){var o=d(n._apiInfo);$.ajax({method:o.iterate.verb?o.iterate.verb:"GET",url:o.Url+o.iterate.url,headers:o.Headers,global:!1,cache:!1,dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(n){for(var t=n.length,i=0;i<t;i++){
var a=n[i];if(a=e(a,a[o.iterate.keyProperty],i+1),void 0!==a)return void r(a)}r()}).fail(function(e,r,n){t(v(o,e,r,n))})})["catch"](t)});return s(t,r),t}function t(e,n){var t=this,o=new h(function(n,o){t.ready().then(function(){var i=l(e),a=t._apiInfo[i.serviceName];$.ajax({method:i.verb,url:a.Url+i.url,dataType:"json",global:!1,cache:!1,contentType:"application/json; charset=utf-8",headers:a.Headers}).done(function(e,t,o){n(r(e,o))}).fail(function(e,r,n){o(v(i,e,r,n))})})["catch"](o)});return s(o,n),o}function o(e,n,t){var o=this,i=new h(function(t,i){o.ready().then(function(){var a=l(e),u=o._apiInfo[a.serviceName];$.ajax({method:a.verb,url:u.Url+a.url,dataType:"json",global:!1,cache:!1,contentType:"application/json; charset=utf-8",headers:u.Headers,data:JSON.stringify(n)}).done(function(e,o,i){n.response=e,t(r(n,i))}).fail(function(e,r,n){i(v(a,e,r,n))})})["catch"](i)});return s(i,t),i}function i(e,r){var n=this;"string"!=typeof e&&(window.console.warn(e+" used as a key, but it is not a string."),e=String(e));var t=new h(function(r,t){n.ready().then(function(){var o=l(e),i=n._apiInfo[o.serviceName];$.ajax({method:o.verb,url:i.Url+o.url,global:!1,cache:!1,headers:i.Headers}).done(function(){r()}).fail(function(e,r,n){t(v(o,e,r,n))})})["catch"](t)});return s(t,r),t}function a(e){var r=this,n=new h(function(e,n){r.ready().then(function(){})["catch"](n)});return s(n,e),n}function u(e){var r=this,n=new h(function(e,n){r.ready().then(function(){})["catch"](n)});return s(n,e),n}function f(e,r){var n=this,t=new h(function(e,r){n.ready().then(function(){})["catch"](r)});return s(t,r),t}function c(e){var r=this,n=new h(function(e,n){r.ready().then(function(){})["catch"](n)});return s(n,e),n}function s(e,r){r&&e.then(function(e){r(null,e)},function(e){r(e)})}function l(e){var r=e.split("|");return{serviceName:r[0],verb:r[1],url:r[2]}}function d(e){var r=null;for(var n in e){r=n;break}return null==r?null:e[r]}function v(e,r,n,t){return{serviceName:e.serviceName,method:e.verb,status:r.status,url:e.url,statusText:n,errorThrown:t,data:r.responseJSON}}var h="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,p={DEFINE:1,EXPORT:2,WINDOW:3},y=p.WINDOW;"undefined"!=typeof module&&module.exports?y=p.EXPORT:"function"==typeof define&&define.amd&&(y=p.DEFINE);var g={_driver:localforageSsatbDriver.DRIVER_NAME,_initStorage:e,_support:!0,iterate:n,getItem:t,setItem:o,removeItem:i,clear:a,length:u,key:f,keys:c};y===p.DEFINE?define(localforageSsatbDriver.DRIVER_NAME,function(){return g}):y===p.EXPORT?module.exports=g:this[localforageSsatbDriver.DRIVER_NAME]=g,localforage.defineDriver(g)}).call(window),angular.module("SSATB.LocalForage",["LocalForageModule"]).provider("ssatbHttp",["$localForageProvider",function(e){function r(e){if(!angular.isObject(n.apiInfo))return null;var r=null;return angular.forEach(n.apiInfo,function(n,t){0===e.toLowerCase().indexOf(n.Url.toLowerCase())&&(r=t)}),r}var n={driver:[localforageSsatbDriver.DRIVER_NAME]};this.config=function(r){if(!angular.isObject(r))throw new Error("The config parameter should be an object");n=angular.extend(n,r),e.config(n)};var t=this.interceptors=[];this.$get=["$localForage","$q","$injector",function(e,o,i){function a(t){if(!angular.isObject(t))throw new Error("Http request configuration must be an object.");if(!angular.isString(t.url))throw new Error("Http request configuration url must be a string.");var i=angular.extend({method:"get"},t);i.method=angular.uppercase(i.method);var a=r(t.url);if(null===a)throw new Error("No matching apiInfo was found in the provider configuration for the service URL "+t.url);var u=[],f=[],l=o.when(i);return angular.forEach(s,function(e){(e.request||e.requestError)&&u.unshift(e.request,e.requestError),(e.response||e.responseError)&&f.push(e.response,e.responseError)}),l=c(l,u),l=l.then(function(r){var o=n.apiInfo[a],u=a+"|"+i.method+"|"+t.url.substring(o.Url.length);return"GET"===i.method?e.getItem(u):"DELETE"===i.method?e.removeItem(u):e.setItem(u,t.data)}),l=l.then(function(e){return null==e?{config:i}:(e.config=i,e)},function(e){throw null!=e?(e.config=i,e):new{config:i}}),c(l,f)}function u(e){angular.forEach(arguments,function(e){a[e]=function(r,n){return a(angular.extend({},n||{},{method:e,url:r}))}})}function f(e){angular.forEach(arguments,function(e){a[e]=function(r,n,t){return a(angular.extend({},t||{},{method:e,url:r,data:n}))}})}function c(e,r){for(var n=0,t=r.length;n<t;){var o=r[n++],i=r[n++];e=e.then(o,i)}return r.length=0,e}var s=[];return angular.forEach(t,function(e){s.unshift(angular.isString(e)?i.get(e):i.invoke(e))}),u("get","delete"),f("post","put"),a}]}]),function(){var e=function(e,r){function n(e,n){function t(e){return e}var o=e+"?serviceName="+n;return r.get(o).then(t)}return this.$window=e,this.$http=r,{refreshToken:n}},r=function(e,r){r.interceptors.push(["$q","$injector","$localForage",function(e,r,t){return{responseError:function(o){function i(e,r){if(null==r.serviceName)return null;var n=e[r.serviceName];return null==n?null:n.ServiceName}var a=e.defer(),u=t._localforage._apiInfo,f=i(u,o),c=r.get("ssatbAuthTokenRefreshConfig");return null==f||null==c.refreshTokenUrl||angular.isUndefined(o.config)||null==o.config||!angular.isUndefined(o.config.retry)&&0!=o.config.retry||401!==o.status?(angular.isUndefined(o.errorHandler)||null==c.errorHandler||c.errorHandler("An unexpected error occurred.  For assistance, please email info@enrollment.org."),a.reject(o)):r.get("authTokenRefreshService").refreshToken(c.refreshTokenUrl,f).then(function(e){var t=u[o.serviceName];t.Headers=e.data,n(o.config,a,r)},function(){angular.isUndefined(o.errorHandler)||null==c.errorHandler||c.errorHandler("An unexpected error occurred.  For assistance, please email info@enrollment.org."),a.reject(o)}),a.promise}}}])},n=function(e,r,n){$ssatbHttp=n.get("ssatbHttp"),e.retry=!0,$ssatbHttp(e).then(function(e){r.resolve(e)},function(e){alertDialog("An unexpected error occurred.  For assistance, please email info@enrollment.org."),r.reject(e)})};angular.module("ssatb.authtokenrefresh",["SSATB.LocalForage"]).provider("ssatbAuthTokenRefreshConfig",["ssatbHttpProvider",function(e){var r={};this.config=function(e){if(!angular.isObject(e))throw new Error("The config parameter should be an object");r=e},this.$get=function(){return r}}]).config(["$provide","ssatbHttpProvider",r]).service("authTokenRefreshService",["$window","$http",e])}();
//# sourceMappingURL=ssatb.localforage.driver.bundle.min.js.map
