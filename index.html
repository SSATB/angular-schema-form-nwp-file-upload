<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Angular Schema Form NWP File Upload</title>
    <!-- CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" media="all" rel="stylesheet">
    <link href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" media="all" rel="stylesheet">
    <link href="schema-form-file.css" media="all" rel="stylesheet" />
</head>
<!-- apply our angular app -->
<body>
    <div id="formApp" class="container">
        <h1>Form with file Demo</h1>
        <div ng-controller="formController">
            <form name="myForm"
                  sf-schema="schema"
                  sf-form="form"
                  sf-model="model"
                  ng-submit="submit()"
                  no-validate></form>
            <pre>{{model|json}}</pre>
            <script type='text/ng-template' id="partials/simpleFileUpload.html">
                <div class="row mb">
                    <div class="col-sm-2 mb-sm attachment-button">
                        <a href ngf-select="uploadFile(picFile)" type="file" ngf-multiple="false" ng-model="picFile" name="file"
                                ng-attr-ngf-pattern="{{form.schema.pattern && form.schema.pattern.mimeType ? form.schema.pattern.mimeType : undefined }}"
                                ng-attr-ngf-max-size="{{form.schema.maxSize && form.schema.maxSize.maximum ? form.schema.maxSize.maximum : undefined }}"
                                ng-required="form.required"
                                accept="{{form.schema.pattern && form.schema.pattern.mimeType}}"
                                ng-model-options="form.ngModelOptions" id="fileInputlink"
                                class="ui icon">
                            <span class="ion-paperclip"></span>
                        </a>
                    </div>
                    <div ng-show="fileUploading" class="col-sm-4 mb-sm">
                        <div class="filename" title="{{ picFile.name }}">{{ picFile.name }}</div>
                    </div>
                    <div ng-show="fileUploading" class="col-sm-4 mb-sm">
                        <div class="progress">
                            <div class="progress-bar progress-bar-striped" role="progressbar"
                                 ng-class="{'progress-bar-success': picFile.progress == 100}"
                                 ng-style="{width: picFile.progress + '%'}">
                                {{ picFile.progress }} %
                            </div>
                        </div>
                    </div>
                    <div ng-messages="uploadForm.$error" ng-messages-multiple="">
                        <div class="text-danger errorMsg" ng-message="maxSize">{{ form.schema[picFile.$error].validationMessage | translate }} <strong>{{picFile.$errorParam}}</strong>. ({{ form.schema[picFile.$error].validationMessage2 | translate }} <strong>{{picFile.size / 1000000|number:1}}MB</strong>)</div>
                        <div class="text-danger errorMsg" ng-message="pattern">{{ form.schema[picFile.$error].validationMessage | translate }} <strong>{{picFile.$errorParam}}</strong></div>
                        <div class="text-danger errorMsg" ng-message="maxItems">{{ form.schema[picFile.$error].validationMessage | translate }} <strong>{{picFile.$errorParam}}</strong></div>
                        <div class="text-danger errorMsg" ng-message="minItems">{{ form.schema[picFile.$error].validationMessage | translate }} <strong>{{picFile.$errorParam}}</strong></div>
                        <div class="text-danger errorMsg" ng-show="errorMsg">{{errorMsg}}</div>
                    </div>
                </div>
                <div>
                    <ul ng-show="uploadedFiles && uploadedFiles.length" class="list-group">
                        <li class="list-group-item" style="border: none;padding:0 0 0 0" ng-repeat="uploadedFile in uploadedFiles">
                            <p>
                                <a href="{{ uploadedFile.downloadUrl }}" download>{{ uploadedFile.name }}</a> 
                            <a href >
                                <span ng-click="deleteFile(uploadedFile)" class="glyphicon glyphicon-remove"></span>
                            </a>
                            </p>
                        </li>
                    </ul>
                </div>
            </script>
        </div>
    </div>
    <!-- JS -->
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" type="text/javascript"></script>
    <script src="bower_components/angular/angular.js" type="text/javascript"></script>
    <script src="bower_components/angular-messages/angular-messages.js" type="text/javascript"></script>
    <script src="bower_components/angular-sanitize/angular-sanitize.min.js" type="text/javascript"></script>
    <script src="bower_components/angular-translate/angular-translate.js" type="text/javascript"></script>
    <script src="bower_components/tv4/tv4.js" type="text/javascript"></script>
    <script src="bower_components/objectpath/lib/ObjectPath.js" type="text/javascript"></script>
    <script src="bower_components/SSATB.LocalForage/dist/ssatb.localforage.driver.bundle.js" type="text/javascript"></script>
    <script src="bower_components/angular-schema-form/dist/schema-form.js" type="text/javascript"></script>
    <script src="bower_components/angular-schema-form/dist/bootstrap-decorator.min.js" type="text/javascript"></script>
    <script src="bower_components/ng-file-upload/ng-file-upload-all.min.js" type="text/javascript"></script>
    <script src="dist/schema-form-file.js" type="text/javascript"></script>
    <script src="app.js" type="text/javascript"></script>
    <script>
        localforage.defineDriver(window[localforageSsatbDriver.DRIVER_NAME]).then(function () {
            angular.bootstrap(document.getElementById("formApp"), ['formApp']);
        });
    </script>

</body>
</html>
